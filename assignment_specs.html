<!DOCTYPE html>
<html>

    <head>
        <title>COS126 Final Assignment</title>
    </head>

    <body>
        <center>
            <h1>Princeton University<br>
                IW Spring 2022</h1>

            <h2>Assignment: A URL Directory Application: Web Version</h2>
        </center>

        <hr>
        <!-- =============================================================== -->

        <h2>Purpose</h2>

        <p>The purpose of this assignment is to help you learn the basic of web programming with
            Django and HTML/CSS/JS.</p>

        <hr>
        <!-- =============================================================== -->

        <h2>Background</h2>

        <h3>Intro to Django</h3>
        <p>Intro to Django</p>
        <h3>Intro to HTML/CSS/JS</h3>
        <p>Intro to HTML/CSS/JS</p>
        <hr>
        <!-- =============================================================== -->
        <h2>Goals</h2>

        <ul>
            <li>ORM</li>
            <li>Debugging</li>
            <li>OOP in Python</li>
            <li>Front-end Development</li>
        </ul>
        <hr>
        <!-- =============================================================== -->

        <h2>Getting Started</h2>

        <p>This is an <strong>individual</strong> assignment. Before you begin coding, do the following:</p>
        <ul>
            <li>
                <p>Unzip the project code into your working directory.
                </p>
            </li>
            <li>
                <p>To run the project, you will need to have Python 3.8.10 (recommended) installed and create a virtual
                    environment.</p>
            </li>

            <li>
                <p>Use the command line, cd into your working directory and run the command: <code> python3 -m venv
                        myenv </code></p>
            </li>

            <li>
                <p>Once the virtual environment is created, you can activate it by running the command:</p>
                <ul>
                    <li>
                        On Windows: <code> myenv\Scripts\activate </code>
                    </li>
                    <li>
                        On Mac: <code> source myenv/bin/activate </code>
                    </li>
                </ul>
            </li>

            <li>
                <p>Once the virtual environment is activated, you can install all dependencies by running: </p>
                <ul>
                    <li>
                        <code> pip install -r requirements.txt </code>
                    </li>
                </ul>

            <li>
                <p>To run the starter code, change directory into <code>link_all</code> and run command:</p>
                <ul>
                    <li>
                        <code> python manage.py runserver </code>
                    </li>
                </ul>
                <p>A server should be running on your machine at <code>http://127.0.0.1:8000/</code></p>
            </li>
            <li>
                <p>On the index page, click on <code>/registration</code> and create an account. You will be logged in
                    automatically.</p>
            </li>
        </ul>
        <hr>
        <!-- =============================================================== -->
        <h2>Project Overview</h2>
        <ul>
            <li>Project <code>link_all</code> contains 2 apps, <code>manage_links</code> and <code>manage_users</code>.</li>
            <li>All template files are located in <code>templates</code> folder.</li>
            <li>All static files are located in <code>static</code> folder.</li>
            <li>The database is stored in <code>db.sqlite3</code> file.</li>
            <li>Specific files you concerned with tasks you will be working on will be listed under each task.</li> 
        </ul>
        <hr>

        <!-- =============================================================== -->
        <h2>Your Task</h2>

        <p> The current application is incomplete and is buggy! Your task is to debug the application and implement
            certain functions to make application... functional.
        </p>

        <p>
            <strong>Make sure to be logged in with your account before you start coding.</strong>
        </p>

        <h3>Task 1: Displaying a user profile</h3>
        <p> Currently, beside you, there is one user in the database, <code>user1</code>.</p>
        <p> Expectedly, <code>user1</code> has profile page. If you look in the <code>manage_users/urls.py</code> file,
        you will find that the URL for the profile page has the form of <code>profile/&lt;username&gt;/</code>.</p>
        
        </p>
            Visist URL <code>&lt;your local host&gt;/profile/user01/</code> you should see a user profile page. Yours!
        </p>


        <hr>
        <!-- =============================================================== -->

        <h2>The Application</h2>

        <p>Compose a program named <code>runserver.py</code>. When executed with <code>-h</code> as a command-line
            argument, <code>runserver.py</code> must display a help message that describes the program's behavior:</p>

        <pre>
$ python runserver.py -h
usage: runserver.py [-h] port

The registrar application

positional arguments:
  port        the port at which the server should listen

optional arguments:
  -h, --help  show this help message and exit
</pre>

        <p>Your <code>runserver.py</code> program must run the Flask test server on the specified port, which in turn
            must run your application.</p>

        <p>Your application's primary page must contain a form. The form must allow the user to specify a
            <code>dept</code>, <code>coursenum</code>, <code>area</code>, and/or <code>title</code>. The form also must
            contain a button that the user can click to submit the form.</p>

        <p>Your program must handle the '%' and '_' characters as ordinary (not wildcard) characters, just as described
            in the Assignment 1 and 2 specifications.</p>

        <p>In addition to the form, your primary page must display a table containing the results of the query that is
            triggered by submission of the form. Specifically, the table must contain the <code>classid</code>,
            <code>dept</code>, <code>coursenum</code>, <code>area</code>, and <code>title</code> of each class that
            matches the specified criteria, or of <em>all</em> classes if the user specifies no criteria. The rows must
            be sorted; the primary sort must be by <code>dept</code> in ascending order, the secondary sort must be by
            <code>coursenum</code> in ascending order, and tertiary sort must be by <code>classid</code> in ascending
            order.</p>

        <p>Along with results of the query, your primary page also must display, within its form, the query criteria
            that user entered to generate those results. For example, if the user entered <code>cos</code> in the
            <code>dept</code> input of the form, entered <code>qr</code> in the <code>area</code> input of the form, and
            submitted the form, then the resulting page must display <code>cos</code> in the <code>dept</code> input of
            the form and <code>qr</code> in the <code>area</code> input of the form &mdash; along with the data for all
            classes that match those query criteria.</p>

        <p>Your primary page must allow the user to click on the <code>classid</code> for any of the classes that it
            displays, thereby allowing the user to learn more about that class. When the user clicks on the
            <code>classid</code> for a particular class, your application must display a "secondary" web page containing
            the selected class's <code>courseid</code>, <code>days</code>, <code>starttime</code>, <code>endtime</code>,
            <code>bldg</code>, <code>roomnum</code>, <code>dept(s)</code>, <code>coursenum(s)</code>, <code>area</code>,
            <code>title</code>, <code>descrip</code>, <code>prereqs</code>, and <code>profname(s)</code>. The data must
            be well formatted.</p>

        <p>The secondary page must contain a page link back to the primary page, thus allowing the user easily to
            perform another class search. In the resulting primary page, the form must show the same data that the user
            entered most recently. The resulting primary page also must show the class data that resulted from the
            submission of that form. Hint: Your application must be <em>stateful</em> to accomplish that.</p>

        <p>Your application must be usable without a pointing device (mouse, touchpad, etc.). That is, your application
            must be usable with only the keyboard. The user must be able to cycle the keyboard focus through the input
            elements and links by pressing the Tab key, and trigger a server interaction by pressing the Enter key.</p>

        <div style="padding:10px;border:5px solid green;">By default, the Firefox browser on Mac does not handle tabbing
            between input elements and links. To enable tabbling, in Firefox click on <em>Preferences -> General</em>
            and make sure the <em>Always use the cursor keys to navigate within pages</em> check button is unchecked.
            Then, in Mac System Preferences, click on <em>Keyboard -> Shortcuts</em> and make sure the <em>All
                Controls</em> radio button is checked.
        </div>

        <p>It is possible to design a better interface than the one just described. (In fact, you will do so later in
            the course!) We assume that the layout of your application's pages will be the same as that of the reference
            application. (A later section of this specification describes how to run the reference application.) If you
            have a principled reason why you would like the layout of your application's pages to differ from that of
            the reference application, then please discuss the matter with the course's instructors before you commit to
            your design. No surprises please!</p>

        <hr>
        <!-- =============================================================== -->

        <h2>Error Handling</h2>

        <p>Your application must be robust. It must handle the following errors:</p>

        <h3>Wrong command-line argument count</h3>

        <p>If <code>runserver.py</code> is given an incorrect number of command-line arguments, then it must write a
            descriptive error message &mdash; the one generated by argparse &mdash; to its <code>stderr</code> and exit
            with status 2.</p>

        <h3>Non-integer port</h3>

        <p>If <code>runserver.py</code> is given a non-integer port command-line argument, then it must write a
            descriptive error message &mdash; the one generated by argparse &mdash; to its <code>stderr</code> and exit
            with status 2.</p>

        <h3>Unavailable port</h3>

        <p>If <code>runserver.py</code> is given a port command-line argument specifying a port that is already in use,
            then it must write a descriptive error message &mdash; the one contained within the thrown exception &mdash;
            to its <code>stderr</code> and exit with status 1.</p>

        <h3>Non-existing classid</h3>

        <p>If the user directly (that is, not through the primary page) commands the browser to fetch a page using a URL
            that has a <code>classid=XXX</code> name/value pair, and no class with classid <code>XXX</code> exists, then
            the application must send to the browser an application-specific reasonably-styled error page that displays
            a "no class with classid XXX exists" error message.</p>

        <p>A non-existing classid error also could occur if (1) the browser sends a "class overviews" query that
            displays data for classid 8321 (the classid for COS 333), (2) some other process deletes the row with
            classid 8321 from the classes table in the database, and (3) the browser sends a "class details" query for
            classid 8321.</p>

        <h3>Missing classid</h3>

        <p>If the user directly (that is, not through the primary page) commands the browser to fetch a secondary page
            using a URL that is missing the <code>classid=XXX</code> name/value pair, or that has a
            <code>classid=XXX</code> name/value pair in which <code>XXX</code> is missing, then the application must
            send to the browser an application-specific reasonably-styled error page that displays a "missing classid"
            error message.</p>

        <h3>Non-integer classid</h3>

        <p>If the user directly (that is, not through the primary page) commands the browser to fetch a secondary page
            using a URL has a <code>classid=XXX</code> name/value pair, and <code>XXX</code> is not an integer, then the
            application must send to the browser an application-specific reasonably-styled error page that displays a
            "non-integer classid" error message.</p>

        <h3>Database cannot be opened</h3>

        <p>If the database cannot be opened when the browser sends a query, then the application must write a
            descriptive error message &mdash; the one contained within the thrown exception object &mdash; to its
            <code>stderr</code>, and send to the browser an application-specific reasonably-styled error page that
            contains the generic "A server error occurred. Please contact the system administrator." error message.</p>

        <h3>Corrupted database</h3>

        <p>If the database is corrupted when the browser sends a query, then the application must write a descriptive
            error message &mdash; the one contained within the thrown exception object &mdash; to its
            <code>stderr</code>, and send to the browser an application-specific reasonably-styled error page that
            contains the generic "A server error occurred. Please contact the system administrator." error message.</p>

        <hr>
        <!-- =============================================================== -->

        <h2>Reference Application</h2>

        <p>A reference application is running at <a
                href="https://assignment3reg.herokuapp.com">https://assignment3reg.herokuapp.com</a>. You can test your
            application by comparing its behavior with that of the reference application.</p>

        <div style="padding:10px;border:5px solid green;">
            Of course the reference application delivers HTML code to your browser. You could use your browser's "view
            source" feature to examine that code. In that sense part of the assignment solution is available to you.
            <strong>Don't examine the code that the reference application delivers to your browser.</strong> Doing that
            would decrease the value of the assignment for you, and would be a violation of course policies.
        </div>
        <br>
        <div style="padding:10px;border:5px solid green;">
            <p>You have no control of the database used by the reference application. So it won't be possible for you to
                run the reference application when its database cannot be opened or has been corrupted. So it won't be
                possible for you to observe the page generated by the reference application in those cases. And so this
                screenshot shows that page:</p>

            <img src="DatabaseErrors.png" width="400">
        </div>

        <hr>
        <!-- =============================================================== -->

        <h2>Testing</h2>

        <p>We'll cover software testing techniques in lectures later in the semester. In the meantime, to test your work
            on this assignment it will be sufficient to rely upon (1) your knowledge of testing from the COS 217 course,
            and (2) this <a href="../TestingTaxonomy.pdf">A Software Testing Taxonomy</a> document.</p>

        <p>Test your application by (1) reviewing this assignment specification thoroughly, making sure that your
            application conforms to every aspect of it, and (2) comparing the behavior of your application with the
            behavior of the reference application.</p>

        <h3>Boundary Testing</h3>

        <p>Focus on <em>boundary</em> (alias <em>corner case</em>) testing. Of course, you must make sure that your
            application handles normal data. But you also must make sure that your application handles unusual data:
            courses that have multiple cross-referenced departments/numbers, long titles, long descriptions, multiple
            professors, no professors, and so forth. You also must make sure that your application handles errors: bad
            manually-entered URLs, missing database, corrupted database, and so forth.</p>

        <p>Hint: Make sure your application handles queries for these titles: <code>"Independent Study"</code>,
            <code>"Independent Study&nbsp;"</code>, <code>"Independent Study&nbsp;&nbsp;"</code>,
            <code>"&nbsp;Independent Study"</code>, and <code>"&nbsp;&nbsp;Independent Study"</code>.</p>

        <h3>Statement Testing</h3>

        <p>Also focus on <em>statement</em> (alias <em>coverage</em>) testing. Your tests should cause every statement
            of your application to be executed.</p>

        <p>You're encouraged, but not required, to use the Python <code>coverage</code> tool to generate a coverage
            report showing which lines of your application have and have not been executed by your tests. These are the
            steps:</p>

        <ol>

            <li>Delete the <code>debug=True</code> argument within the call of <code>app.run()</code>. The Python
                coverage tool doesn't work with Flask in debug mode.</li>

            <li>Launch your application server via the command <code>python -m coverage run -p --source=. runserver.py
                    <em>someport</em></code>.</li>

            <li>Use a browser to interact with your application, thereby creating a <code>.coverage<em>X</em></code>
                file.</li>

            <li>Exit your application server.</li>

            <li>Repeat steps 2 through 4 as desired.</li>

            <li>Issue the command <code>python -m coverage combine</code> to combine the coverage reports generated by
                steps 2 through 4 into one large coverage report in a file named <code>.coverage</code>.</li>

            <li>Issue the command <code>python -m coverage html</code> to use the <code>.coverage</code> file to
                generate a human-readable report as a set of HTML documents in a directory named <code>htmlcov</code>.
            </li>

            <li>Browse to <code>htmlcov/index.html</code> to check the report.</li>

            <li>The files in your <code>htmlcov</code> directory should show that 100% of your application's lines were
                executed. If the report doesn't show 100% coverage, then revise your testing plan accordingly, delete
                the <code>.coverage</code> file and the <code>htmlcov</code> directory, and repeat steps 2 through 8.
            </li>
        </ol>

        <div style="padding:10px;border:5px solid green;">
            If you're using a MS Windows local computer...<br><br>

            Issuing the command <code>python -m coverage run -p runserver.py <em>someport</em></code> creates a process
            that should loop infinitely. On a MS Windows system, the easiest way for you to kill that process is by
            typing Ctrl-c, Ctrl-break, or whatever works on your particular computer.<br><br>

            However, on at least some MS Windows computers, killing the process in that abrupt way suppresses generation
            of the coverage report. So you may not be able to generate your coverage report on your local MS Windows
            computer. You may need to generate your coverage report on courselab.
        </div>

        <h3>Test Automation</h3>

        <p>It's not easy to automate the testing of a web application. But you could do so using a tool named <a
                href="https://www.selenium.dev/">Selenium</a>. See me if you're interested; I can provide a minimal
            example showing how to get started testing your application with Selenium. If you're clever you could use
            Selenium to generate your coverage report.</p>

        <hr>
        <!-- =============================================================== -->

        <h2>Submission</h2>

        <p>Compose a <code>readme</code> file. If you're working on the assignment alone, then the first line of your
            <code>readme</code> file must contain your Princeton netid, and nothing else. If you're working on the
            assignment with a teammate, then the first line of your <code>readme</code> file must contain your Princeton
            netid and your teammate's Princeton netid with an underscore between the two, and nothing else. That
            information in that format will help us to automate the process of determining who worked with whom.</p>

        <p>Thereafter your <code>readme</code> file must contain:</p>

        <ul>
            <li>Your name, your teammate's name, and the assignment number.</li>

            <li>A paragraph describing your contribution, and another paragraph describing your teammate's contribution.
                Please be thorough; we're looking for two substantial paragraphs, not a sentence or two.</li>

            <li>A description of whatever help (if any) you received from other people while doing the assignment, as
                prescribed by the course <em>Policies</em> web page.</li>

            <li>A description of the sources of information that you used while doing the assignment.</li>

            <li>An indication of how much time you spent doing the assignment.</li>

            <li>Your assessment of the assignment: Did it help you to learn? What did it help you to learn? Do you have
                any suggestions for improvement? Etc.</li>

            <li>(Optionally) Any information that will help us to grade your work in the most favorable light. In
                particular you must describe all known bugs.</li>
        </ul>

        <p>Your <code>readme</code> file must be a plain text file. Don't create your <code>readme</code> file using
            Microsoft Word or any other word processor.</p>

        <p>Submit your assignment files on <code>courselab</code> using these commands:</p>

        <blockquote>
            <pre>
submit 3 readme
submit 3 runserver.py
submit 3 <em>allFilesComprisingYourApplication</em>
</pre>
        </blockquote>

        <p>As noted above in the <em>Rules</em> section, it must be the case that either you submit all of your team's
            files or your teammate submits all of your team's files. (It must not be the case that you submit some of
            your team's files and your teammate submits some of your team's files.) You may submit multiple times; we'll
            grade the latest files that you submit.</p>

        <p><strong>
                <font color="red">Please follow the rules on what to submit.</font>
            </strong> It will be a big help to us if you get the filenames right and submit exactly what's asked for.
            Thanks.</p>

        <hr>
        <!-- =============================================================== -->

        <h2>Grading</h2>

        <p>Assume that your grader already has activated the cos333 virtual environment before he/she runs your
            programs. The document from the first lecture entitled <em>A COS 333 Computing Environment</em> describes
            the cos333 virtual environment.</p>

        <p>Your grade will be based upon:</p>

        <ul>
            <li>Correctness, that is, the correctness of your application as specified by this document and the given
                reference application.</li>

            <li>Style, that is, the quality of your program style as reported by the <code>pylint</code> tool, when
                using the given <code>.pylintrc</code> file, and when executed via the command <code>python -m pylint
                    *.py</code>.</li>
        </ul>

        <p>Ten points (that is, ten percent) of your grade will be based upon the quality of your program style as
            reported by <code>pylint</code>. Your grader will start with the 10-point score reported by
            <code>pylint</code>. Your grader then will "round down" that score to the 0.5 level to compute your program
            style grade. For example, if your <code>pylint</code> score is 9.8, then your program style grade will be
            9.5; if your <code>pylint</code> score is 7.4, then your program style grade will be 7.0.</p>

        <p>If your code fails the tests on some particular functionality, then your grader won't be able to inspect your
            code manually to try to assign partial credit for that functionality. So please make sure your code behaves
            properly.</p>

        <hr>
        <!-- =============================================================== -->

        <p align="right"><small>This assignment was written by Robert M. Dondero, Jr.</small></p>

    </body>

</html>
